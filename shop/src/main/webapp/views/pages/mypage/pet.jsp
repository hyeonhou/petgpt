<%@ page pageEncoding="UTF-8" %>
  <%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
    <%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>

      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">


      <style>
        .site-btn>a {
          color: white;
        }

        #category {
          color: rosybrown;
        }

        .pet-box {
          margin: 10px;
          padding: 15px;
          background-color: white;
          box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.2);
          border-radius: 10px;
          transition: transform 0.3s ease
        }

        .pet-box:hover {
          transform: translateY(-8px) scale(1.02) rotateZ(0.3deg);
          box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }

        .pet-name-box {
          margin-top: 10px;
          padding: 10px;
        }

        .pet-img-box img {
          margin: 10px;
          width: 100%;
          aspect-ratio: 1 / 1;
        }

        .modal-content {
          background-color: #fff;
          position: relative;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          /* Ï§ëÏïô Ï†ïÎ†¨ ÌïµÏã¨! */
          width: 600px;
          /* ÎÑàÎπÑ Ï°∞Ï†à (ÏõêÌïòÎäî Í∞íÏúºÎ°ú) */
          padding: 20px;
          border-radius: 10px;
          box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
          max-height: 95vh;
          overflow-y: auto;
        }

        .modal-input-box {
          margin: 10px;
        }
      </style>

      <!-- Breadcrumb Section Begin -->
      <section class="breadcrumb-option">
        <div class="container">
          <div class="row">
            <div class="col-lg-12">
              <div class="breadcrumb__text">
                <h4>Mypage</h4>
                <div class="breadcrumb__links">
                  <a href="<c:url value='/'/>">Home</a>
                  <a href="<c:url value='#'/>">ÎßàÏù¥ÌéòÏù¥ÏßÄ</a>
                  <span>ÎÇòÏùò Ìé´ Ï†ïÎ≥¥</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <!-- Breadcrumb Section End -->

      <!-- Data for JS -->
      <div id="pet-data" style="display: none;" data-context-path="${pageContext.request.contextPath}"
        data-default-profile-img="<c:url value='/img/clients/profile.png'/>">
      </div>


      <section class="shop spad">
        <div class="container">
          <div class="row">
            <%-- ÏòÜ ÏÇ¨Ïù¥Îìú Î∞î(ÎßàÏù¥ÌéòÏù¥ÏßÄ Ïπ¥ÌÖåÍ≥†Î¶¨) --%>
              <div class="col-lg-3">
                <div class="shop__sidebar">
                  <div class="shop__sidebar__accordion">
                    <div class="accordion" id="accordionExample">
                      <div class="card">
                        <div class="card-heading">
                          <a data-toggle="collapse">ÎÇòÏùò Ï†ïÎ≥¥</a>
                        </div>
                        <div id="collapseOne" class="collapse show" data-parent="#accordionExample">
                          <div class="card-body">
                            <div class="shop__sidebar__categories">
                              <ul style="height:auto;">
                                <li><a href="<c:url value='/mypage?id=${cust.custId}'/>">ÌöåÏõêÏ†ïÎ≥¥</a></li>
                                <li><a href="<c:url value='/pet?id=#${cust.custId}'/>"><strong
                                        id="category">ÎÇòÏùò Ìé´ Ï†ïÎ≥¥</strong></a></li>
                              </ul>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="card">
                        <div class="card-heading">
                          <a data-toggle="collapse">ÎÇòÏùò ÏáºÌïë Ï†ïÎ≥¥</a>
                        </div>
                        <div id="collapseTwo" class="collapse show" data-parent="#accordionExample">
                          <div class="card-body">
                            <div class="shop__sidebar__categories">
                              <ul style="height: auto;">
                                <li><a href="<c:url value='/checkout/orderlist?id=${cust.custId}'/>">Ï£ºÎ¨∏ÎÇ¥Ïó≠</a></li>
                                <li><a href="<c:url value='/address?id=${cust.custId}'/>">Î∞∞ÏÜ°ÏßÄ Î™©Î°ù</a></li>
                                <li><a href="<c:url value='/coupon?id=${cust.custId}'/>">Î≥¥Ïú† Ïø†Ìè∞</a></li>
                              </ul>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="card">
                        <div class="card-heading">
                          <a data-toggle="collapse">ÎÇòÏùò ÌôúÎèô</a>
                        </div>
                        <div id="collapseThree" class="collapse show" data-parent="#accordionExample">
                          <div class="card-body">
                            <div class="shop__sidebar__categories">
                              <ul style="height:auto;">
                                <li><a href="<c:url value='/mypage/view?id=${cust.custId}'/>">ÏµúÍ∑º Î≥∏ ÏÉÅÌíà</a></li>
                                <li><a href="<c:url value='/mypage/like?id=${cust.custId}'/>">Ï∞ú Î™©Î°ù</a></li>
                                <li><a href="<c:url value='/qnaboard?id=${cust.custId}'/>">1:1Î¨∏Ïùò</a></li>
                                <li><a href="<c:url value='/review?id=${cust.custId}'/>">ÎÇ¥Í∞Ä ÏûëÏÑ±Ìïú Î¶¨Î∑∞</a></li>
                              </ul>
                              <br /><br />
                              <button class="site-btn" id="logout_btn"><a href="<c:url value="
                                    /logout" />">Î°úÍ∑∏ÏïÑÏõÉ</a></button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
              <%-- ÌöåÏõê Ï†ïÎ≥¥ --%>
                <div class="col-lg-9 container mt-3">
                  <h4><strong>üê∂ ÎÇòÏùò Ìé´ Ï†ïÎ≥¥</strong></h4>
                  <h6 class="checkout__title"></h6>
                  <h6 class="coupon__code"><span class="icon_tag_alt"></span> Ïù¥ÎØ∏ÏßÄÎ•º ÌÅ¥Î¶≠ÌïòÎ©¥ ÏàòÏ†ïÌï† Ïàò ÏûàÏñ¥Ïöî!</h6>
                  <div class="row">
                    <c:forEach var="p" items="${pets}">
                      <div class="col-md-6">
                        <div class="pet-box">
                          <div style="display: flex; justify-content: space-between; align-items: center;">
                            <h5 style="margin: 10px auto; color:lightgray">Î∞òÎ†§ÎèôÎ¨º Îì±Î°ùÏ¶ù</h5>
                            <p style="text-align:right; cursor: pointer;" onclick="pet.del(${p.petKey})">&times;</p>
                          </div>
                          <div class="row">
                            <div class="col-md-6">
                              <form id="pet_update_form" action="${pageContext.request.contextPath}/pet/petimgupdate"
                                method="post" enctype="multipart/form-data">
                                <input type="file" id="fileInput" name="petImg" style="display: none;"
                                  onchange="pet.submitForm()" />
                                <input type="hidden" value="${p.custId}" name="custId">
                                <input type="hidden" value="${p.petKey}" name="petKey">

                              </form>
                              <div class="pet-img-box">
                                <img src="<c:url value='${p.petImg}'/>" alt="ÌòÑÏû¨ Ï≤®Î∂ÄÌååÏùº"
                                  onclick="document.getElementById('fileInput').click();" style="cursor: pointer;">
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="pet-name-box">
                                <h5>
                                  <c:choose>
                                    <c:when test="${p.petType eq 'cat'}">
                                      üê±
                                    </c:when>
                                    <c:otherwise>
                                      üê∂
                                    </c:otherwise>
                                  </c:choose>
                                  <strong>${p.petName}</strong>
                              </div>
                              <hr>
                              <div class="pet-desc-box">
                                <div>‚ñ™ ÏÉùÏùº:
                                  <fmt:formatDate value="${p.petBirthdate}" pattern="yyyy.MM.dd" />
                                </div>
                                <div>‚ñ™ ÏÑ±Î≥Ñ:
                                  <c:choose>
                                    <c:when test="${p.petGender eq 'M'}">
                                      ÎÇ®Ïûê
                                    </c:when>
                                    <c:otherwise>
                                      Ïó¨Ïûê
                                    </c:otherwise>
                                  </c:choose>
                                </div>
                                <div>‚ñ™ Ï¢ÖÎ•ò: ${p.petBreed}</div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </c:forEach>
                  </div>
                  <hr>
                  <div class="checkout__order">
                    <button class="site-btn" id="pet_add_btn" onclick="openModal()">Î∞òÎ†§ÎèôÎ¨º Îì±Î°ùÌïòÍ∏∞</button>
                  </div>
                </div>
          </div>
        </div>
      </section>

      <%--Î™®Îã¨Ï∞Ω--%>
        <div id="petModal" class="modal" style="display: none;">
          <div class="modal-content" style="background-color:#edede9">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <h4 style="text-align:center">Î∞òÎ†§ÎèôÎ¨º Îì±Î°ùÏπ¥Îìú ÎßåÎì§Í∏∞üêæ</h4>
            <form id="pet_add_form" enctype="multipart/form-data">
              <hr>
              <!-- ÎÇ¥Ïö©ÏãúÏûë -->
              <div class="row">
                <div class="col-md-12">
                  <div class="pet-box">
                    <div class="row">
                      <div class="col-md-6">
                        <div class="pet-img-box">
                          <img id="profile-img" name="img" src="<c:url value='/img/clients/profile.png'/>">
                        </div>
                      </div>
                      <div class="col-md-6">
                        <div class="pet-name-box"><strong id="modal-pet-type"></strong> <strong
                            id="modal-pet-name">Ïù¥Î¶Ñ</strong></div>
                        <hr>
                        <div class="pet-desc-box">
                          <div id="modal-pet-birthdate">‚ñ™ ÏÉùÎÖÑÏõîÏùº:</div>
                          <div id="modal-pet-gender">‚ñ™ ÏÑ±Î≥Ñ:</div>
                          <div id="modal-pet-breed">‚ñ™ Ï¢Ö:</div>
                          <input type="file" id="uploadFile" name="img" hidden><br><br>
                          <label for="uploadFile" class="btn btn-light">üìÅ Ïù¥ÎØ∏ÏßÄ Ï∞æÍ∏∞</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="form-group col-md-4">
                  <div class="checkout__input">
                    <label for="petName">‚úî Ïù¥Î¶Ñ</label>
                    <input type="text" placeholder="Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî." id="petName" name="petName">
                    <input type="hidden" value="${sessionScope.cust.custId}" id="custId" name="custId">
                  </div>
                </div>
                <div class="form-group col-md-4">
                  <div class="checkout__input">
                    <label for="petType">‚úî ÌÉÄÏûÖ</label><br />
                    <select id="petType" class="form-select" name="petType">
                      <option value="">Í∞ïÏïÑÏßÄ?Í≥†ÏñëÏù¥?</option>
                      <option value="dog">üê∂ Í∞ïÏïÑÏßÄ</option>
                      <option value="cat">üê± Í≥†ÏñëÏù¥</option>
                    </select>
                  </div>
                </div>
                <div class="form-group col-md-4">
                  <div class="checkout__input">
                    <label for="petGender">‚úî ÏÑ±Î≥Ñ</label><br />
                    <select id="petGender" class="form-select" name="petGender">
                      <option value="">ÏÑ†ÌÉùÌïòÏÑ∏Ïöî!</option>
                      <option value="M"> ÎÇ®Ïûê</option>
                      <option value="F"> Ïó¨Ïûê</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="form-group col-md-6">
                  <div class="checkout__input">
                    <label for="petBreed">‚úî Ï¢Ö</label>
                    <input type="text" placeholder="Ï¢ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî." id="petBreed" name="petBreed">
                  </div>
                </div>
                <div class="form-group col-md-6">
                  <div class="checkout__input">
                    <label for="petBirthdate">‚úî ÏÉùÏùº</label>
                    <input type="date" id="petBirthdate" name="petBirthdate">
                  </div>
                </div>
              </div>
            </form>
            <div id="msg" style="color:darkred; margin-bottom:20px;"></div>
            <button class="site-btn" id="modal_pet_add_btn">Îì±Î°ùÌïòÍ∏∞</button>
          </div>
        </div>